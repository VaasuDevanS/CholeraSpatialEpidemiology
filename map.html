<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title> Spatial Epidemiology | Map </title>
        <meta name="keywords" content="Cholera, GIS, Spatial, Leaflet" />
        <meta name="description" content="Interactive Web GIS for Cholera Spatial Epidemiology" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="icon" href="static/images/favicon.png">
        
        <link href="static/templatemo_style.css" rel="stylesheet" type="text/css" />
        
        <link href="static/leaflet/leaflet.css" rel="stylesheet" type="text/css" /> <!-- Leaflet 1.5.1 -->
        <script src="static/leaflet/leaflet.js"> </script> <!-- Leaflet 1.5.1 -->
        
        <link href="static/leaflet/leaflet-measure.css" rel="stylesheet" type="text/css" /> <!-- Leaflet 1.5.1 -->
        <script src="static/leaflet/leaflet-measure.js"> </script> <!-- Leaflet 1.5.1 -->
        
        <script src="static/layers.js"> </script>

    </head>
<body> 
<br>
<div id="templatemo_wrapper">
  
  <div id="templatemo_header">
        <div id="templatemo_menu">
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="background.html">Background</a></li>
                <li><a href="gap.html">Gap</a></li>
                <li><a href="objectives.html">Objectives</a></li>
                <li><a href="results.html">Results</a></li>
                <li><a href="map.html" class="current">Map</a></li>
                <li><a href="downloads.html">Downloads</a></li>
            </ul>
        </div> <!-- end of templatemo_menu -->
        
        <div id="site_title">
            <h1><a href="http://www.templatemo.com" target="_parent">Spatial <strong>Epidemiology</strong> <span> CHOLERA </span></a></h1>
        </div> <!-- end of site_title -->
  </div> <!-- end of templatemo_header -->
  
  <div id="templatemo_main">
      <div id="map" style="width:900px; height:420px;"> <div>
      <div class="cleaner"></div>
  </div> <!-- end of templatemo_main -->

</div>  <!-- end of templatemo_wrapper --> <br>

<div id="templatemo_footer">
    <div class="three_column">
      <div class="button"><a href="javascript:;" onclick="map.fitBounds(LayerGroup.getBounds())">Zoom to Layers</a> </div>
    </div>
    <div class="three_column" style="color: white; width: 400px;">
      Legend: Cholera Cases | Latrines | Water Sources
    </div>  
</div> <!-- end of templatemo_footer -->

<script>

var choleraCaseIcon = L.icon({
    iconUrl: 'static/images/icon_cholera_case.png',
    iconSize: [20, 20],
    iconAnchor: [16, 37],
    popupAnchor: [0, -28]
  });

var latrineIcon = L.icon({
    iconUrl: 'static/images/icon_latrine.png',
    iconSize: [20, 20],
    iconAnchor: [16, 37],
    popupAnchor: [0, -28]
  });

var waterSourceIcon = L.icon({
    iconUrl: 'static/images/icon_water_source.png',
    iconSize: [20, 20],
    iconAnchor: [16, 37],
    popupAnchor: [0, -28]
  });


cases = L.geoJSON(cholera_cases, {
           pointToLayer: function (feature, latlng) {
              return L.marker(latlng, {icon: choleraCaseIcon});
           },
           onEachFeature: function(feature, layer){
              fields = ["CaseId", "Age", "Sex", "DiarrhoeaY", "VomitingYN", "NameOfColl"];
              content = "";
              fields.forEach(function(item, index){
                  content += "<b>" + item + "</b>: "+ feature.properties[item] + "<br>";
              })
              layer.bindPopup(content);
              layer.on('mouseover', function(f) { layer.openPopup() });
              layer.on('mouseout', function(f) { layer.closePopup() });
           }
        })

latrines = L.geoJSON(pit_latrines, {
              pointToLayer: function (feature, latlng) {
                 return L.marker(latlng, {icon: latrineIcon});
              },
              onEachFeature: function(feature, layer){
                 fields = ["CaseID", "DropCover", "TypeofToil"];
                 content = "";
                 fields.forEach(function(item, index){
                     content += "<b>" + item + "</b>: "+ feature.properties[item] + "<br>";
                 });
                 layer.bindPopup(content);
                 layer.on('mouseover', function(f) { layer.openPopup() });
                 layer.on('mouseout', function(f) { layer.closePopup() });
              }
           })

water_sources = L.geoJSON(unprotected_water_source, {
                   pointToLayer: function (feature, latlng) {
                      return L.marker(latlng, {icon: waterSourceIcon});
                   },
                   onEachFeature: function(feature, layer){
                      fields = ["Name", "TotalHouse", "WaterSourc"];
                      content = "";
                      fields.forEach(function(item, index){
                          content += "<b>" + item + "</b>: "+ feature.properties[item] + "<br>";
                      });
                      layer.bindPopup(content);
                      layer.on('mouseover', function(f) { layer.openPopup() });
                      layer.on('mouseout', function(f) { layer.closePopup() });
                   }
                })

LayerGroup = L.featureGroup([cases, latrines, water_sources]);

var map = L.map('map', {layers: LayerGroup});

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
}).addTo(map);


map.fitBounds(LayerGroup.getBounds());
L.control.scale().addTo(map);

L.control.layers({}, {"cases": cases,
                      "latrines": latrines,
                      "water_sources": water_sources}).addTo(map);

var measureControl = L.control.measure({position: 'topleft',
                                        primaryLengthUnit: 'feet',
                                        secondaryLengthUnit: 'meters',
                                        activeColor: 'red',
                                        completedColor: 'red'});
measureControl.addTo(map);

</script>
</body>
</html>
